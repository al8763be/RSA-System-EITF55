
import random
import Euklides


def rsa(p,q):
    N = p * q
    phi_n = (p - 1)*(q - 1)
    e = (2**16) + 1
    d,_ = Euklides.inverse(e, phi_n)

    s = random.randint(2, p*q - 1)

    print(f"s used: {s}")

    c = pow(s, e, N)
    print(f"c: {c}")

    z = pow(c, d, N) 
    print(f"z: {z}")
    
    print(z == s)

    print("e*d mod phi(n) =", (e * d) % phi_n) 

p = 6938168183909476011711423782569145937582334327321712545715885438989823478711798510227258253737276814067807836904995661948940619120070366127008027527066103
q = 6799567461568200705908991986699895231497109379651706284696168519150076160951283987365163549611749850876280551858508087641524105908392504380214123161150113


rsa(p,q)
